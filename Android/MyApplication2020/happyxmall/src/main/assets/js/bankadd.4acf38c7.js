(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["bankadd"],{"0ee0":function(t,e,n){},2994:function(t,e,n){"use strict";n("68ef"),n("e3b3"),n("c0c2")},"2bdd":function(t,e,n){"use strict";var a=n("d282"),i=n("02de"),r=n("a8c1"),o=n("5fbe"),s=n("543e"),c=Object(a["a"])("list"),l=c[0],u=c[1],d=c[2];e["a"]=l({mixins:[Object(o["a"])((function(t){this.scroller||(this.scroller=Object(r["d"])(this.$el)),t(this.scroller,"scroll",this.check)}))],model:{prop:"loading"},props:{error:Boolean,loading:Boolean,finished:Boolean,errorText:String,loadingText:String,finishedText:String,immediateCheck:{type:Boolean,default:!0},offset:{type:[Number,String],default:300},direction:{type:String,default:"down"}},data:function(){return{innerLoading:this.loading}},updated:function(){this.innerLoading=this.loading},mounted:function(){this.immediateCheck&&this.check()},watch:{loading:"check",finished:"check"},methods:{check:function(){var t=this;this.$nextTick((function(){if(!(t.innerLoading||t.finished||t.error)){var e,n=t.$el,a=t.scroller,r=t.offset,o=t.direction;e=a.getBoundingClientRect?a.getBoundingClientRect():{top:0,bottom:a.innerHeight};var s=e.bottom-e.top;if(!s||Object(i["a"])(n))return!1;var c=!1,l=t.$refs.placeholder.getBoundingClientRect();c="up"===o?e.top-l.top<=r:l.bottom-e.bottom<=r,c&&(t.innerLoading=!0,t.$emit("input",!0),t.$emit("load"))}}))},clickErrorText:function(){this.$emit("update:error",!1),this.check()},genLoading:function(){var t=this.$createElement;if(this.innerLoading&&!this.finished)return t("div",{key:"loading",class:u("loading")},[this.slots("loading")||t(s["a"],{attrs:{size:"16"}},[this.loadingText||d("loading")])])},genFinishedText:function(){var t=this.$createElement;if(this.finished){var e=this.slots("finished")||this.finishedText;if(e)return t("div",{class:u("finished-text")},[e])}},genErrorText:function(){var t=this.$createElement;if(this.error){var e=this.slots("error")||this.errorText;if(e)return t("div",{on:{click:this.clickErrorText},class:u("error-text")},[e])}}},render:function(){var t=arguments[0],e=t("div",{ref:"placeholder",key:"placeholder",class:u("placeholder")});return t("div",{class:u(),attrs:{role:"feed","aria-busy":this.innerLoading}},["down"===this.direction?this.slots():e,this.genLoading(),this.genFinishedText(),this.genErrorText(),"up"===this.direction?this.slots():e])}})},"2f02":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bankadd"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.step,expression:"step"}],staticClass:"firStep"},[n("van-nav-bar",{attrs:{fixed:"","left-arrow":"",title:"添加银行卡"},on:{"click-left":t.jumpBack}}),n("div",{attrs:{id:"content"}},[n("p",{staticClass:"titleGlobal"},[t._v("请填写您的银行卡信息")]),n("van-field",{staticClass:"font-gray",style:""===t.hidename?"display:none":"display:flex",attrs:{label:"持卡人",placeholder:"请输入您的银行卡号",readonly:"",type:"text"},on:{input:t.inputFun},model:{value:t.hidename,callback:function(e){t.hidename=e},expression:"hidename"}}),n("van-field",{attrs:{label:"银行卡号",placeholder:"请输入您的银行卡号",type:"number"},on:{focus:function(e){return t.end(e)},input:t.inputFun,keyup:function(e){return t.end(e)}},model:{value:t.bankcard,callback:function(e){t.bankcard=e},expression:"bankcard"}}),n("div",{staticClass:"bankbox",on:{click:t.selectBank}},[n("van-cell",{attrs:{"is-link":"",title:"银行"}}),n("div",{staticClass:"bankinfo"},[n("img",{style:t.banklogoimg?"display:block":"display:none",attrs:{src:t.banklogoimg}}),n("input",{staticClass:"van-field__control",attrs:{placeholder:"请选择银行",readonly:""},domProps:{value:t.bankName}})])],1),n("van-button",{class:t.firbutton,attrs:{block:"",type:"primary"},on:{click:t.firFun}},[t._v("下一步")])],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:t.secStep,expression:"secStep"}],staticClass:"secStep"},[n("van-nav-bar",{attrs:{fixed:"","left-arrow":"",title:"验证银行卡信息"},on:{"click-left":function(e){t.secStep=!1,t.step=!0}}}),n("div",{attrs:{id:"content"}},[n("van-field",{staticClass:"font-gray",style:""===t.hidename?"display:none":"display:flex",attrs:{label:"持卡人",placeholder:"请输入您的银行卡号",readonly:"",type:"text"},on:{input:t.inputFun},model:{value:t.hidename,callback:function(e){t.hidename=e},expression:"hidename"}}),n("van-field",{staticClass:"font-gray",attrs:{label:"银行卡号",placeholder:"请输入您的银行卡号",readonly:"",type:"number"},model:{value:t.bankcard,callback:function(e){t.bankcard=e},expression:"bankcard"}}),n("div",{staticClass:"bankbox"},[n("van-cell",{staticClass:"font-gray",attrs:{title:"银行"}}),n("div",{staticClass:"bankinfo"},[n("img",{attrs:{src:t.banklogoimg}}),n("input",{staticClass:"van-field__control font-gray",attrs:{placeholder:"请选择银行",readonly:""},domProps:{value:t.bankName}})])],1),n("p",{staticClass:"titleGlobal"},[t._v("填写银行预留信息，后续只能添加该持卡人的银行卡")]),n("van-field",{style:""===t.hidename?"display:flex":"display:none",attrs:{label:"持卡人",placeholder:"请输入持卡人姓名",type:"text"},on:{input:t.inputFunSec},model:{value:t.realName,callback:function(e){t.realName=e},expression:"realName"}}),n("van-field",{style:""===t.hidename?"display:flex":"display:none",attrs:{label:"身份证号",placeholder:"请输入持卡人身份证号",type:"text"},on:{input:t.inputFunSec},model:{value:t.idcard,callback:function(e){t.idcard=e},expression:"idcard"}}),n("van-field",{attrs:{label:"手机号",placeholder:"请输入您的手机号",type:"number"},on:{input:t.inputFunSec},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}}),n("van-button",{class:t.secbutton,attrs:{block:"",type:"primary"},on:{click:t.secFun}},[t._v("验证手机号")])],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:t.thiStep,expression:"thiStep"}],staticClass:"thiStep"},[n("van-nav-bar",{attrs:{fixed:"","left-arrow":"",title:"手机短信验证"},on:{"click-left":t.goback}}),n("div",{attrs:{id:"content"}},[n("p",{staticClass:"titleGlobal"},[t._v("请输入手机"+t._s(t.phone.substring(0,3))+"****"+t._s(t.phone.substring(t.phone.length-4,t.phone.length))+"收到的短信验证码")]),n("van-cell-group",[n("van-field",{attrs:{label:"验证码",maxlength:"4",placeholder:"短信验证码",type:"number"},on:{input:t.inputFunThi},model:{value:t.mobileCode,callback:function(e){t.mobileCode=e},expression:"mobileCode"}}),n("div",{staticClass:"countdownBox"},[n("span",{class:t.countdownClass,on:{click:function(e){return t.countdownFun()}}},[t._v(t._s(t.countdownHtml))])])],1),n("div",{staticClass:"operationBox",on:{click:t.showMq}},[n("a",{staticClass:"light"},[t._v("无法收到短信？")])]),n("van-button",{class:t.thibutton,attrs:{block:"",type:"primary"},on:{click:t.submitButton}},[t._v("验证信息")])],1)],1)])},i=[],r=(n("ac1f"),n("5319"),n("96cf"),n("c964")),o=n("f3f3"),s=n("2f62"),c=n("ed08"),l={name:"MyBankadd",data:function(){return{step:!0,secStep:!1,thiStep:!1,bankcard:window.localStorage.getItem("bankcard")?window.localStorage.getItem("bankcard"):"",banklogoimg:window.localStorage.getItem("bankImg")?window.localStorage.getItem("bankImg"):"",bankName:window.localStorage.getItem("bankname")?window.localStorage.getItem("bankname"):"",bankuuid:window.localStorage.getItem("bankuuid")?window.localStorage.getItem("bankuuid"):"",realName:"",idcard:"",phone:"",mobileCode:"",countdownHtml:"重新发送",countdown:0,countdownClass:"",timer:null,device:"01",key:"8279a48ec7c8a6303bde3f979ce77a9d",codeType:"fundcode",firbutton:window.localStorage.getItem("bankcard")&&""!==window.localStorage.getItem("bankcard")&&window.localStorage.getItem("bankuuid")&&""!==window.localStorage.getItem("bankuuid")?"light":"",secbutton:"",thibutton:"",hidename:""}},components:{},mounted:function(){this.getUserInfo()},watch:{hidename:function(t){var e=this;this.$nextTick((function(){e.bankcard=t.replace(/\D/g,"").replace(/....(?!$)/g,"$& ")}))},bankcard:function(t){var e=this;this.$nextTick((function(){e.bankcard=t.replace(/\D/g,"").replace(/....(?!$)/g,"$& ")}))}},methods:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(s["b"])("User",["getToken"])),Object(s["b"])("MeiQia",["showMq","metadata"])),{},{getUserInfo:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getToken();case 2:return e.t0=e.sent,n={token:e.t0},e.next=6,t.$api.get("/user/get",n);case 6:a=e.sent,t.realName=a.realname,t.idcard=a.idcard,a.realname&&(t.hidename="*"+a.realname.substring(a.realname.length-1,a.realname.length));case 10:case"end":return e.stop()}}),e)})))()},getBankcardList:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getToken();case 2:return e.t0=e.sent,n={token:e.t0},e.next=6,t.$api.get("/bankcard/list",n);case 6:t.banklist=e.sent;case 7:case"end":return e.stop()}}),e)})))()},submitButton:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!Object(c["h"])(t.mobileCode)){e.next=3;break}return t.$toast("Do not enter special characters"),e.abrupt("return",!1);case 3:if("light"!==t.thibutton){e.next=23;break}return e.t0=t.bankuuid,e.t1=Object(c["a"])(t.bankcard.replace(/\s+/g,"")),e.t2=Object(c["a"])(t.idcard.replace(/\s+/g,"")),e.t3=Object(c["a"])(t.mobileCode.replace(/\s+/g,"")),e.t4=Object(c["a"])(t.phone.replace(/\s+/g,"")),e.t5=t.realName.replace(/\s+/g,""),e.next=12,t.getToken();case 12:return e.t6=e.sent,n={bank:e.t0,bankcard:e.t1,idcard:e.t2,mobileCode:e.t3,phone:e.t4,realName:e.t5,token:e.t6},e.next=16,t.$api.post("/bankcard/add",n);case 16:window.localStorage.removeItem("bankImg"),window.localStorage.removeItem("bankuuid"),window.localStorage.removeItem("bankname"),window.localStorage.removeItem("bankcard"),window.localStorage.removeItem("bankbutton"),t.$toast("添加成功"),window.localStorage.getItem("backUrl")?t.$router.replace("/withdrawal"):t.$router.replace("/bankcard");case 23:case"end":return e.stop()}}),e)})))()},startCountdown:function(){var t=this;this.countdown=60,this.timer=setInterval((function(){t.countdown--,t.countdown<=0?(t.countdownHtml="重新获取",t.countdownClass="light",clearInterval(t.timer)):(t.countdownClass="",t.countdownHtml=t.countdown+"s")}),1e3)},countdownFun:function(){if(this.countdown>0)return!1;try{this.sendCode(),this.startCountdown(),this.$toast("短信验证码已发送")}catch(t){this.$toast(t)}},sendCode:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,a,i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$api.get("/login/getTime");case 2:return n=e.sent,a=t.key+n+t.phone.replace(/\s+/g,"")+t.codeType,i=Object(c["a"])(t.device+"123456"+n+Object(c["b"])(a)),r={codeType:Object(c["a"])(t.codeType),deviceType:Object(c["a"])("tsmqry"),mobile:Object(c["a"])(t.phone.replace(/\s+/g,"")),token:i},e.next=8,t.$api.get("/sms/sendCode",r);case 8:t.smsCode=e.sent;case 9:case"end":return e.stop()}}),e)})))()},inputFun:function(){""!==this.bankcard&&this.bankuuid?this.firbutton="light":this.firbutton=""},firFun:function(){var t=/^[0-9]{12,21}$/,e=this.hidename.replace(/\s+/g,""),n=this.bankcard.replace(/\s+/g,"");if(Object(c["h"])(n))return this.$toast("银行卡号Do not enter special characters"),!1;t.test(e)||t.test(n)?"light"===this.firbutton&&(this.step=!1,this.secStep=!0):this.$toast("银行卡格式不正确")},inputFunSec:function(){if(Object(c["h"])(this.realName)||Object(c["h"])(this.idcard)||Object(c["h"])(this.phone))return this.$toast("Do not enter special characters"),!1;""!==this.realName&&""!==this.idcard&&""!==this.phone?this.secbutton="light":this.secbutton=""},secFun:function(){var t=/^(((13[0-9])|(14[5-7])|(15[0-9])|(17[0-9])|(18[0-9])|(19[0-9]))+\d{8})$/,e=/(^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$)|(^[1-9]\d{5}\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}$)/,n=this.idcard.replace(/\s+/g,""),a=this.phone.replace(/\s+/g,"");e.test(n)?t.test(a)?"light"===this.secbutton&&(this.thiStep=!0,this.secStep=!1,this.countdownFun()):this.$toast("手机号格式不正确"):this.$toast("身份证号格式不正确")},inputFunThi:function(){""!==this.mobileCode?this.thibutton="light":this.thibutton=""},goback:function(){this.secStep=!0,this.thiStep=!1,clearInterval(this.timer),this.countdownHtml="重新发送",this.countdown=0},selectBank:function(){this.$router.push("/bankselect"),window.localStorage.setItem("bankcard",this.bankcard),window.localStorage.setItem("bankbutton",this.firbutton)},jumpBack:function(){window.localStorage.getItem("backUrl")?this.$router.replace("/withdrawal"):this.$router.replace("/bankcard")},showMq:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$router.push("/olark");case 1:case"end":return e.stop()}}),e)})))()},end:function(t){var e=t.srcElement;e.focus(),e.selectionStart=e.value.length,e.selectionEnd=e.value.length}})},u=l,d=(n("8848"),n("2877")),h=Object(d["a"])(u,a,i,!1,null,"48e90e58",null);e["default"]=h.exports},"36a3":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bankadd"},[n("van-nav-bar",{attrs:{fixed:"","left-arrow":"",title:"选择银行"},on:{"click-left":function(e){return t.$router.history.go(-1)}}}),n("div",{attrs:{id:"content"}},[n("p",{staticClass:"titleGlobal"},[t._v("支持银行")]),n("list",t._l(t.banklist,(function(e){return n("van-row",{key:e.uuid,class:["item",t.bankData.uuid===e.uuid?"light":""],on:{click:function(n){return t.selectBank(e)}}},[n("van-col",[n("img",{staticClass:"avatar",attrs:{src:""+e.logoUrl,alt:""}})]),n("van-col",{staticClass:"name"},[t._v(t._s(e.shortName))])],1)})),1)],1)],1)},i=[],r=(n("ac1f"),n("5319"),n("96cf"),n("c964")),o=(n("2994"),n("2bdd")),s={name:"MyBankselect",data:function(){return{banklist:[],bankData:{uuid:window.localStorage.getItem("bankuuid")}}},components:{List:o["a"]},mounted:function(){this.getBankList()},methods:{getBankList:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$api.get("/bank/list");case 2:t.banklist=e.sent,t.$store.commit("setLoading",!1);case 4:case"end":return e.stop()}}),e)})))()},selectBank:function(t){this.bankData=t,window.localStorage.setItem("bankImg",t.logoUrl),window.localStorage.setItem("bankuuid",t.uuid),window.localStorage.setItem("bankname",t.shortName),this.$router.replace("/bankadd")}}},c=s,l=(n("94db"),n("2877")),u=Object(l["a"])(c,a,i,!1,null,"e5d61f12",null);e["default"]=u.exports},8848:function(t,e,n){"use strict";var a=n("0ee0"),i=n.n(a);i.a},"8beb":function(t,e,n){},"94db":function(t,e,n){"use strict";var a=n("fc80"),i=n.n(a);i.a},"94f4":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"setting"},[n("van-nav-bar",{attrs:{fixed:"","left-arrow":"",title:"银行卡详情"},on:{"click-left":function(e){return t.$router.history.go(-1)}}}),n("div",{attrs:{id:"content"}},[n("div",{class:["item",t.classname]},[n("div",{staticClass:"item-top"},[n("img",{staticClass:"avatar",attrs:{src:""+t.bankInfo.logoUrl,alt:""}}),n("p",[t._v(t._s(t.bankInfo.name))])]),n("b",[t._v(t._s(t.bankInfo.bankcard.replace(/\s/g,"").replace(/(.{4})/g,"$1 ")))])]),n("van-field",{attrs:{label:"持卡人姓名"},model:{value:t.bankInfo.accountHolder,callback:function(e){t.$set(t.bankInfo,"accountHolder",e)},expression:"bankInfo.accountHolder"}}),n("van-field",{attrs:{value:t.format(t.bankInfo.createtime),label:"添加时间"}}),n("van-button",{attrs:{block:"",type:"default"},on:{click:t.submitButton}},[t._v("解除绑定")])],1)],1)},i=[],r=(n("b0c0"),n("ac1f"),n("5319"),n("e17f"),n("2241")),o=(n("96cf"),n("c964")),s=n("f3f3"),c=n("2f62"),l=n("ed08"),u={name:"MyBankDetail",data:function(){return{banklist:[],bankInfo:{bankcard:""},classname:window.localStorage.getItem("bankcarditem")}},components:{},mounted:function(){this.getInfo()},methods:Object(s["a"])(Object(s["a"])({},Object(c["b"])("User",["getToken"])),{},{getInfo:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=t.$route.params.id,e.next=3,t.getToken();case 3:return e.t1=e.sent,n={uuid:e.t0,token:e.t1},e.next=7,t.$api.get("/bankcard/get",n);case 7:t.bankInfo=e.sent,t.$store.commit("setLoading",!1);case 9:case"end":return e.stop()}}),e)})))()},submitButton:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r["a"].confirm({message:"是否解除绑定尾号为"+t.bankInfo.bankcard.substring(t.bankInfo.bankcard.length-4,t.bankInfo.bankcard.length)+"的"+t.bankInfo.name+"银行卡？",closeOnClickOverlay:!0,confirmButtonText:"解除绑定"}).then((function(){t.beforeClose()})).catch((function(){}));case 1:case"end":return e.stop()}}),e)})))()},beforeClose:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=t.$route.params.id,e.next=3,t.getToken();case 3:return e.t1=e.sent,n={uuid:e.t0,token:e.t1},e.next=7,t.$api.post("/bankcard/delete",n);case 7:t.banklist=e.sent,t.$toast("操作成功"),t.$router.replace("/bankcard");case 10:case"end":return e.stop()}}),e)})))()},format:function(t){return t?Object(l["c"])(new Date(t),"yyyy年MM月dd日"):"0000年00月00日"}})},d=u,h=(n("d52c"),n("2877")),b=Object(h["a"])(d,a,i,!1,null,"05ab9367",null);e["default"]=b.exports},c0c2:function(t,e,n){},d52c:function(t,e,n){"use strict";var a=n("8beb"),i=n.n(a);i.a},fc80:function(t,e,n){}}]);