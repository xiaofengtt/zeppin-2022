function redPack(options){this.el=options.el;this.rains=[];this.speed=options.speed;this.density=options.density;this.callback=options.callback;};redPack.prototype.create=function(id,amount){var el=this.el,This=this,flag=true,fragment=document.createDocumentFragment(),nRed=document.createElement("span");nRed.setAttribute("redId",id);nRed.setAttribute("redAmount",amount);if(id==="020"||id==="040"||id==="060"||id==="080"||id==="096"){nRed.className="redpacked"}else{nRed.className="redpack"}nRed.style.left=Math.random()*(el.clientWidth-30)+"px";nRed.style.top= -el.clientHeight/10+"px";fragment.appendChild(nRed);el.appendChild(fragment);this.rains.push(nRed);this.move(nRed);var handler=function(e){if(flag===true){var that=nRed;e.target.className="clicked";This.callback(e);flag=false}else{return}};document.addEventListener('touchstart',function(e){if(e.target.className==='redpack'||e.target.className==='redpacked'){handler(e)}else if(e.target.getAttribute('redAmount')==='0'){e.target.className='redPackNone'}else{return false}})};redPack.prototype.start=function(data){var that=this,i=0;that.timer=setInterval(function(){if(i<=data.length-1){var id=data[i].id,amount=data[i].amount;that.create(id,amount);i+=1}},that.density)};redPack.prototype.stop=function(){var This=this;clearInterval(This.timer);for(var i=0;i<This.rains.length;i+=1){clearInterval(This.rains[i].timer)}};redPack.prototype.move=function(rains){var el=this.el;var This=this;var diffY=Math.random()+1;var diffX=Math.random();rains.timer=setInterval(function(){if(diffY>1.5){rains.style.left=parseInt(rains.style.left)+parseInt(diffX*rains.clientHeight/30)+"px"}else{rains.style.left=parseInt(rains.style.left)-parseInt(diffX*rains.clientHeight/30)+"px"}rains.style.top=parseInt(rains.style.top)+parseInt(diffY*rains.clientHeight/20)+"px";if(el.clientHeight<parseInt(rains.style.top)){clearInterval(rains.timer);el.removeChild(rains)}},This.speed)};redPack.prototype.clear=function(){var container=g('box'),redItem=container.childNodes;for(var i=redItem.length-1;i>=0;i-=1){container.removeChild(redItem[i])}};redPack.prototype.ajax=function(opt){opt=opt||{};opt.method=(opt.method==null?"GET":opt.method.toUpperCase());opt.url=opt.url||'';opt.async=opt.async||true;opt.data=opt.data||null;opt.success=opt.success||function(){};var xmlHttp=null;if(XMLHttpRequest){xmlHttp=new XMLHttpRequest()}else{xmlHttp=new ActiveXObject('Microsoft.XMLHTTP')}var params=[];for(var key in opt.data){params.push(key+'='+opt.data[key])}var postData=params.join('&');if(opt.method.toUpperCase()==='POST'){xmlHttp.open(opt.method,opt.url,opt.async);xmlHttp.setRequestHeader('Content-Type','application/x-www-form-urlencoded;charset=utf-8');xmlHttp.send(postData)}else if(opt.method.toUpperCase()==='GET'){xmlHttp.open(opt.method,opt.url+'?'+postData,opt.async);xmlHttp.send(null)}xmlHttp.onreadystatechange=function(){if(xmlHttp.readyState===4&&xmlHttp.status===200){opt.success(xmlHttp.responseText)}}};